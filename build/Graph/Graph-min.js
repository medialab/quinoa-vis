"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}(),_react=require("react"),_react2=_interopRequireDefault(_react);require("./Graph.scss"),require("gexf");var SIGMA_SETTINGS={labelThreshold:7,minNodeSize:2,edgeColor:"default",defaultEdgeColor:"#D1D1D1",sideMargin:0},sigInst=new sigma({settings:SIGMA_SETTINGS}),camera=sigInst.addCamera("main");camera.isAnimated=!0;var Graph=function(e){function r(e,t){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t))}return _inherits(r,e),_createClass(r,[{key:"componentDidMount",value:function(){var e=this,r=(new DOMParser).parseFromString(this.props.data[0].gexf,"application/xml");this.renderer=sigInst.addRenderer({container:this.container,camera:"main"}),sigma.parsers.gexf(r,sigInst,function(){return sigInst.refresh()});var t=function(){var r={cameraX:camera.x,cameraY:camera.y,cameraRatio:camera.ratio,cameraAngle:camera.angle};e.props.updateView(r)};camera.bind("coordinatesUpdated",t)}},{key:"componentWillUpdate",value:function(e){if(JSON.stringify(this.props.viewParameters)!==JSON.stringify(e.viewParameters)){var r={x:e.viewParameters.cameraX,y:e.viewParameters.cameraY,angle:e.viewParameters.cameraAngle,ratio:e.viewParameters.cameraRatio};camera.goTo(r),sigInst.refresh()}}},{key:"componentDidUpdate",value:function(e){if(e.data!==this.props.data){var r=(new DOMParser).parseFromString(this.props.data[0].gexf,"application/xml");sigInst.graph.clear(),sigma.parsers.gexf(r,sigInst,function(){camera.goTo(),sigInst.refresh(),sigInst.loadCamera("main")})}}},{key:"componentWillUnmount",value:function(){sigInst.killRenderer(this.renderer)}},{key:"render",value:function(){var e=this;return _react2.default.createElement("div",{id:"sigma-container",ref:function(r){return e.container=r}})}}]),r}(_react.Component);exports.default=Graph;