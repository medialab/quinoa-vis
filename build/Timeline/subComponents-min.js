"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Brush=exports.ClustersGroup=exports.Controls=exports.TimeTicks=exports.TimeObject=void 0;var _createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),TimeObject=exports.TimeObject=function(t){var e=t.point,o=t.scale,n=t.color,r=void 0===n?"grey":n,a=t.showLabel,i=void 0===a||a,s=t.showTooltip,c=void 0===s||s;return _react2.default.createElement("span",{className:"time-object"+(e.endDate?" period":" point"),style:{top:o(e.startDate.getTime())+"%",height:e.endDate?o(e.endDate.getTime())-o(e.startDate.getTime())+"%":void 0}},_react2.default.createElement("span",{className:"marker",style:{background:r}}),i?_react2.default.createElement("span",{className:"name-container"},_react2.default.createElement("span",{className:"name"},e.name.length>27?e.name.substr(0,30)+"...":e.name,_react2.default.createElement("span",{className:"name-underline",style:{borderColor:r}}))):"",c?_react2.default.createElement("span",{className:"tooltip",style:{borderColor:r}},e.name):"")},TimeTicks=exports.TimeTicks=function(t){var e=t.ticks,o=t.scale;return _react2.default.createElement("div",{className:"time-graduations-container"},e.map(function(t,e){return _react2.default.createElement("p",{className:"tick",key:e,style:{top:o(t.time)+"%"}},_react2.default.createElement("span",{className:"legend"},t.legend))}))},Controls=exports.Controls=function(t){var e=t.zoomIn,o=t.zoomOut,n=t.panBackward,r=t.panForward;return _react2.default.createElement("div",{className:"controls-container"},_react2.default.createElement("button",{onMouseDown:n,id:"left"},"backward"),_react2.default.createElement("button",{onMouseDown:r,id:"right"},"forward"),_react2.default.createElement("button",{onMouseDown:e,id:"zoom-in"},"zoom-in"),_react2.default.createElement("button",{onMouseDown:o,id:"zoom-out"},"zoom-out"))},ClustersGroup=exports.ClustersGroup=function(t){var e=t.clusters,o=t.viewParameters,n=t.scale;return _react2.default.createElement("div",{className:"columns-container"},e.columns.map(function(t){return _react2.default.createElement("div",{key:t,className:"objects-column"},e.timeObjects.filter(function(e){return e.column===t}).map(function(t,e){return _react2.default.createElement(TimeObject,{key:e,point:t,scale:n,color:o.colorsMap[t.category],showLabel:!t.overlapped})}))}))},getEventCoordinates=function(t){var e=t.target.clientWidth,o=t.target.clientHeight,n=t.target.offsetLeft,r=t.target.offsetTop,a=t.clientX-n,i=t.clientY-r,s=a/e,c=i/o;return{relativeX:a,relativeY:i,absoluteX:t.clientX,absoluteY:t.clientY,portionX:s,portionY:c}},Brush=exports.Brush=function(t){function e(t){_classCallCheck(this,e);var o=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.state={canBrushContainer:!1,brushingContainer:!1,containerBrushStartPosition:void 0,brushInteractionMode:void 0,brushMoveStartPosition:void 0},o}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){var t=this,e=this.props,o=e.scale,n=e.fromDate,r=e.toDate,a=e.onSimpleClick,i=e.onSpanEventDefinition,s=e.allowBrush,c=function(){t.setState({canBrushContainer:!1,brushingContainer:!1,containerBrushStartPosition:void 0,brushInteractionMode:void 0,brushMoveStartPosition:void 0})},u=function(e){e.stopPropagation(),t.state.brushInteractionMode&&"move"===t.state.brushInteractionMode&&a(getEventCoordinates(e))},l=function(e){e.stopPropagation(),t.state.brushingContainer!==!1||t.state.brushInteractionMode||a(getEventCoordinates(e)),t.state.brushingContainer&&t.setState({brushingContainer:!1}),t.state.canBrushContainer&&t.setState({canBrushContainer:!1}),t.state.brushInteractionMode&&t.setState({brushInteractionMode:void 0})},p=function(e){e.stopPropagation(),t.state.canBrushContainer||t.setState({canBrushContainer:!0}),t.setState({containerBrushStartPosition:void 0})},d=function(e){e.stopPropagation();var o=getEventCoordinates(e);if(t.state.canBrushContainer)if(t.state.brushingContainer){var n=getEventCoordinates(e),r=t.state.containerBrushStartPosition,a=n;if(r&&a&&r.portionY>=0&&r.portionY<=1&&a.portionY>=0&&a.portionY<=1){var s=t.state.containerBrushStartPosition.portionY<n.portionY?t.state.containerBrushStartPosition:n,c=n.portionY>t.state.containerBrushStartPosition.portionY?n:t.state.containerBrushStartPosition;i(s,c)}}else t.setState({brushingContainer:!0,containerBrushStartPosition:o});else t.state.brushingContainer&&t.setState({brushingContainer:!1});"resize-top"===t.state.brushInteractionMode?i(void 0,{portionY:o.portionY}):"resize-bottom"===t.state.brushInteractionMode?i({portionY:o.portionY},void 0):"move"===t.state.brushInteractionMode&&(t.state.brushMoveStartPosition?u(e):t.setState({brushMoveStartPosition:o}))},h=function(e){if(e.stopPropagation(),!t.state.brushInteractionMode){var o=getEventCoordinates(e),n=void 0,r=void 0;o.portionY<.2?n="resize-top":o.portionY>.8?n="resize-bottom":(n="move",r=o),t.setState({brushInteractionMode:n,brushMoveStartPosition:r})}},f=function(e){e.stopPropagation(),t.setState({brushInteractionMode:void 0})};return s?_react2.default.createElement("div",{className:"brush-placeholder",onClick:l,onMouseDown:p,onMouseMove:d,onMouseLeave:c},_react2.default.createElement("div",{className:"brush",onClick:f,onMouseDown:h,style:{top:o(n)+"%",height:o(r)-o(n)+"%",pointerEvents:this.state.brushingContainer||this.state.brushInteractionMode?"none":"all"}})):_react2.default.createElement("div",{className:"brush-placeholder"},_react2.default.createElement("div",{className:"brush",style:{top:o(n)+"%",height:o(r)-o(n)+"%",pointerEvents:"none"}}))}}]),e}(_react2.default.Component);